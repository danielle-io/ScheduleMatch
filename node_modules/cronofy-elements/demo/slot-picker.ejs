<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Embedding demo: availability viewer</title>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.js"></script>
    <link href="/demo/demo-styles.css" rel="stylesheet">
</head>
<body class="trouble">

    <% var slug = 'slot-picker'; %>
    <%- include nav.ejs %>

    <h1>Slot Picker</h1>
    <div id="cronofy-slot-picker"></div>
    <p>Lorem ipsum, dolor sit amet consectetur adipisicing elit. Recusandae, doloribus eaque? Animi, velit culpa nostrum omnis vitae rem placeat ut mollitia autem porro! Qui molestiae porro rerum similique, aliquid deleniti!</p>
    <div id="cronofy-slot-picker-two"></div>
    <hr>
    <div class="wrapper">
        <div class="column">
            <h2>Consectetur adipisicing elit</h2>
            <p>Lorem ipsum dolor sit, amet consectetur adipisicing elit. <a href="/">Voluptate sed ex totam odit</a> quae hic voluptatibus, quisquam dicta animi laborum velit laboriosam, placeat suscipit tenetur voluptates! Illo tempora minus animi.</p>
            <p>Lorem ipsum, dolor sit amet consectetur adipisicing elit. Quidem consequuntur repudiandae nesciunt, totam dicta earum deleniti magnam eveniet eligendi sunt adipisci veniam esse aliquid aperiam corporis optio fuga tempora sit!</p>
        </div>
        <div class="column">
            <h2>Est deserunt non quis do quis nostrud ad exercitation proident incididunt.</h2>
            <p>Excepturi dicta neque ut, a expedita quaerat, tempore dolor placeat quibusdam cumque ipsam cum officia voluptate, ea fuga optio necessitatibus inventore tempora?</p>
            <p>Lorem ipsum dolor sit, amet consectetur adipisicing elit. Natus nisi eveniet voluptas provident esse beatae minus at error dignissimos neque? Temporibus velit numquam aut labore porro neque ipsum, deleniti a?</p>
            <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Eum sunt eligendi, error quos nulla dolorem alias corrupti iste fugiat deleniti nam unde, porro provident a voluptatem at voluptates, dolores sed!</p>
        </div>
    </div>
    <p>Lorem ipsum dolor sit, amet consectetur adipisicing elit. Natus nisi eveniet voluptas provident esse beatae minus at error dignissimos neque? Temporibus velit numquam aut labore porro neque ipsum, deleniti a?</p>
    <p>Lorem ipsum dolor sit, amet consectetur adipisicing elit. Debitis saepe maxime corporis nemo hic rerum porro in repudiandae? Libero eligendi impedit reiciendis exercitationem fuga ex eos aliquid itaque facere corrupti.</p>    
    <hr>
    <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Eum sunt eligendi, error quos nulla dolorem alias corrupti iste fugiat deleniti nam unde, porro provident a voluptatem at voluptates, dolores sed!</p>
    <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptatum commodi fuga laboriosam? Quas officiis doloremque iure modi, ipsam dolore ad illum saepe et voluptatum quis tempore ullam dolor, sequi nulla!</p>
    <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Eum sunt eligendi, error quos nulla dolorem alias corrupti iste fugiat deleniti nam unde, porro provident a voluptatem at voluptates, dolores sed!</p>

    <script src="../build/CronofyElements.dev.js"></script>
    <!-- <script src="https://elements.cronofy.com/js/CronofyElements.v0.10.9.js"></script> -->

    <script>
        console.log('loading elements...');
        const locale = 'fr';

        const display = {
            // 0 = don't show the element
            // 1 = show the element
            one: 1,
            two: 1
        }


        if (display.one) {
            const slotTimes = function(days, time) {
                const timeString = `${moment().utc().format("YYYY-MM-DD")}T${time}:00Z`;
                const output = moment(timeString)
                    .add(days, "days");
                return output.utc().format();
            };

            CronofyElements.SlotPicker({
                element_token: "<%= slot_picker_token %>",
                target_id: 'cronofy-slot-picker',
                api_domain:"<%= api_domain %>",
                availability_query: {
                    participants: [
                        {
                            required: "all",
                            members: [
                                {
                                    sub: "<%= sub %>",
                                    // managed_availability: true
                                }
                            ]
                        }
                    ],
                    required_duration: { minutes: 30 },
                    available_periods: [
                        { start: slotTimes(1,"07:00"), end: slotTimes(1,"12:00") },
                        { start: slotTimes(2,"09:00"), end: slotTimes(2,"13:00") },
                        { start: slotTimes(2,"14:00"), end: slotTimes(2,"17:00") },
                        { start: slotTimes(3,"09:00"), end: slotTimes(3,"13:00") },
                        { start: slotTimes(3,"14:00"), end: slotTimes(3,"17:00") },
                        { start: slotTimes(4,"09:00"), end: slotTimes(5,"17:00") }
                        // { start: slotTimes(3,"06:00"), end: slotTimes(3,"17:00") }
                    ]
                },
                styles: {
                    prefix: "SP1"
                },
                config: {
                    logs: 'info'
                },
                // locale: 'keys',
                // translations: {
                //     en: {
                //         slot_picker: {
                //             select_day: 'Override select_day'
                //         }
                //     }
                // },
                callback: slot => console.log('callback',slot),
                // locale: locale,
                // demo: true
            });
        }
        
        if (display.two) {
            const slotTimes = function(days, time) {
                const timeString = `${moment().utc().format("YYYY-MM-DD")}T${time}:00Z`;
                const output = moment(timeString)
                    .add(days, "days");
                return output.utc().format();
            };

            CronofyElements.SlotPicker({
                element_token: "<%= slot_picker_token %>",
                target_id: 'cronofy-slot-picker-two',
                api_domain:"<%= api_domain %>",
                availability_query: {
                    participants: [
                        {
                            required: "all",
                            members: [
                                { sub: "<%= sub %>" }
                            ]
                        }
                    ],
                    required_duration: { minutes: 30 },
                    available_periods: [
                        { start: slotTimes(1,"23:00"), end: slotTimes(2,"01:00") },
                        { start: slotTimes(2,"23:00"), end: slotTimes(3,"01:00") }
                    ]
                },
                config: {
                    mode: 'no_confirm'
                },
                styles: {
                    prefix: "SP2",
                    padding: "20px"
                },
                callback: slot => console.log('callback',slot),
                // locale: locale,
                demo: true
            });
        }

        console.log('done.');
    </script>

</body>
</html>
