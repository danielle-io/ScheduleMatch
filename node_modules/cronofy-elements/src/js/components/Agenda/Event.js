import React, { useContext } from "react";

import EventWrapper from "./EventWrapper";
import EventMessages from "./EventMessages";
import EventTime from "./EventTime";
import EventMeta from "./EventMeta";
import { getCalColor } from "../../helpers/events";
import { truncateString } from "../../helpers/utils";

import { CalendarsContext, ThemeContext } from "./Agenda";

const Event = props => {
    const theme = useContext(ThemeContext);
    const calendars = useContext(CalendarsContext);
    const calIndex = getCalColor(props.data.calendar_id, calendars);
    return (
        <EventWrapper
            calIndex={calIndex}
            data={props.data}
            expand={props.expand}
        >
            <EventMessages data={props.data} />
            <EventTime
                start={props.data.start}
                end={props.data.end}
                current={props.current}
                recurring={props.data.recurring}
            />
            <span className={`${theme.prefix}__event__title`}>
                {truncateString(props.data.summary, 40)}
            </span>

            <EventMeta data={props.data} calIndex={calIndex} />
        </EventWrapper>
    );
};

export default Event;
